<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Robo Teacher Voice Test</title>
</head>
<body>
  <h2>Upload a Valid WAV File</h2>
  <form id="uploadForm" enctype="multipart/form-data">
    <input type="file" name="audio" accept=".wav" required>
    <button type="submit">Upload & Listen</button>
  </form>

  <h3 id="responseText"></h3>
  <audio id="audioPlayer" controls style="display: none;"></audio>

  <script>
    document.getElementById("uploadForm").onsubmit = async function(e) {
      e.preventDefault();
      const formData = new FormData(this);

      const res = await fetch("/listen/", {
        method: "POST",
        body: formData,
      });

      const result = await res.json();
      if (result.text) {
        document.getElementById("responseText").innerText = result.text;
        const audio = document.getElementById("audioPlayer");
        audio.src = result.voice_url;
        audio.style.display = "block";
        audio.play();
      } else {
        alert("Error: " + (result.error || "Something went wrong"));
      }
    };
  </script>
</body>
</html>
